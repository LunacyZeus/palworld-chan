import{be as D,a8 as N,c as $,d as A,r as v,l as k,aV as x,aW as b,a6 as S,aH as B,ak as E,Y as F,aj as p,ai as H,aY as O,aP as R,b1 as U,b2 as V,b as y,bf as W,p as _,bg as z,aU as I,b3 as C,w as L}from"./9a74f89d.js";function P(t,i){return t.reduce((o,c)=>Math.abs(o-i)<Math.abs(c-i)?o:c)}const q={gap:D(24),icon:String,axis:N("y"),magnetic:String,offset:{type:Object,default:()=>({x:-1,y:-1})},teleport:{type:[String,Object],default:"body"}},[G,Y]=$("floating-bubble");var J=A({name:G,inheritAttrs:!1,props:q,emits:["click","update:offset","offsetChange"],setup(t,{slots:i,emit:o,attrs:c}){const r=v(),l=v({x:0,y:0,width:0,height:0}),n=k(()=>({top:t.gap,right:x.value-l.value.width-t.gap,bottom:b.value-l.value.height-t.gap,left:t.gap})),d=v(!1);let m=!1;const M=k(()=>{const e={},u=S(l.value.x),a=S(l.value.y);return e.transform=`translate3d(${u}, ${a}, 0)`,(d.value||!m)&&(e.transition="none"),e}),w=()=>{if(!f.value)return;const{width:e,height:u}=I(r.value),{offset:a}=t;l.value={x:a.x>-1?a.x:x.value-e-t.gap,y:a.y>-1?a.y:b.value-u-t.gap,width:e,height:u}},s=B();let h=0,g=0;const X=e=>{s.start(e),d.value=!0,h=l.value.x,g=l.value.y};E("touchmove",e=>{if(e.preventDefault(),s.move(e),t.axis!=="lock"&&!s.isTap.value){if(t.axis==="x"||t.axis==="xy"){let a=h+s.deltaX.value;a<n.value.left&&(a=n.value.left),a>n.value.right&&(a=n.value.right),l.value.x=a}if(t.axis==="y"||t.axis==="xy"){let a=g+s.deltaY.value;a<n.value.top&&(a=n.value.top),a>n.value.bottom&&(a=n.value.bottom),l.value.y=a}const u=C(l.value,["x","y"]);o("update:offset",u)}},{target:r});const T=()=>{d.value=!1,p(()=>{if(t.magnetic==="x"){const e=P([n.value.left,n.value.right],l.value.x);l.value.x=e}if(t.magnetic==="y"){const e=P([n.value.top,n.value.bottom],l.value.y);l.value.y=e}if(!s.isTap.value){const e=C(l.value,["x","y"]);o("update:offset",e),(h!==e.x||g!==e.y)&&o("offsetChange",e)}})},j=e=>{s.isTap.value?o("click",e):e.stopPropagation()};F(()=>{w(),p(()=>{m=!0})}),H([x,b,()=>t.gap,()=>t.offset],w);const f=v(!0);return O(()=>{f.value=!0}),R(()=>{t.teleport&&(f.value=!1)}),()=>{const e=U(y("div",_({class:Y(),ref:r,onTouchstartPassive:X,onTouchend:T,onTouchcancel:T,onClickCapture:j,style:M.value},c),[i.default?i.default():y(W,{name:t.icon,class:Y("icon")},null)]),[[V,f.value]]);return t.teleport?y(z,{to:t.teleport},{default:()=>[e]}):e}}});const Z=L(J);export{Z as F};
